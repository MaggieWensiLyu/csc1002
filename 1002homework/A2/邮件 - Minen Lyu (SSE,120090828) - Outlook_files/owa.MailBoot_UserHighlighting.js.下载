self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~UserHighlighting.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[869],{10122:function(e,t,n){"use strict";function r(e){return!(e.CopyAllowed&&e.ForwardAllowed&&e.ReplyAllAllowed&&e.ReplyAllowed&&e.PrintAllowed)}n.d(t,"a",(function(){return r}))},10124:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r=n(7630),i=n(24),a=n(1955),o=n(979),u="UserHighlight",c=Object(o.a)({FieldURI:"UserHighlightData"}),s={featureId:u,propertyPaths:[c],isPropertyExistedOnItem:function(e){var t=a.a.items.get(e);return t&&null!=t.userHighlightData},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(i.i)("rp-userMarkup"))return!1;var n=a.a.items.get(e);return n&&!Object(r.a)(n)}};t.a=s},10125:function(e,t,n){"use strict";n.d(t,"c",(function(){return u})),n.d(t,"a",(function(){return c}));var r=n(7630),i=n(24),a=n(1955),o=n(4922),u="UserNote",c="UserNoteData",s={featureId:u,propertyPaths:[o.f],isPropertyExistedOnItem:function(e){var t=a.a.items.get(e);return t&&null!=t.userNoteData},shouldGetItemPropertiesFromServer:function(e,t){if(!Object(i.i)("rp-userMarkup"))return!1;var n=a.a.items.get(e);return n&&!Object(r.a)(n)}};t.b=s},11967:function(e,t,n){var r=n(16978),i=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},1426:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(734);function i(e){var t={viewmodel:"ReadMessageItem",ItemID:encodeURIComponent(e),ispopout:"1"};return Object(r.a)(t)}},16978:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'._1urPxDscnvJ7unrfTyqNOp{text-decoration:inherit}html[dir] ._1urPxDscnvJ7unrfTyqNOp{border-radius:2px;padding:0 1px;background-color:"[theme:highlightYellowLight, default:rgba(255, 241, 0, .16)]"}._1urPxDscnvJ7unrfTyqNOp:hover{cursor:pointer}html[dir] ._1urPxDscnvJ7unrfTyqNOp:hover{background-color:"[theme:highlightYellow, default:rgba(255, 241, 0, .30)]"}._3jeqMIU2uRa5T5yNWT7AGh{text-decoration:inherit}html[dir] ._3jeqMIU2uRa5T5yNWT7AGh{border-radius:2px;padding:0 1px;background-color:"[theme:themeLighter, default:#DEECF9]"}._3jeqMIU2uRa5T5yNWT7AGh:hover{cursor:pointer}html[dir] ._3jeqMIU2uRa5T5yNWT7AGh:hover{background-color:"[theme:themeLight, default:#C7E0F4]"}',""]),t.locals={userHighlight:"_1urPxDscnvJ7unrfTyqNOp",userNote:"_3jeqMIU2uRa5T5yNWT7AGh"}},16979:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,'._3f4MFgCmXZw5tsAxv_YZmy,._2n2fxh7KEVUQ1c3qBZ0qfj{display:inline-block}html[dir] ._2n2fxh7KEVUQ1c3qBZ0qfj{padding:4px}._1dKkLlfJNDv2-dR32zwie5{width:32px;height:32px;color:"[theme:neutralSecondary, default:#605e5c]";-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto}html[dir] ._1dKkLlfJNDv2-dR32zwie5{background:"[theme:white, default:#ffffff]";border-radius:2px}html[dir=ltr] ._1dKkLlfJNDv2-dR32zwie5{margin:0 2px 2px 0}html[dir=rtl] ._1dKkLlfJNDv2-dR32zwie5{margin:0 0 2px 2px}._1dKkLlfJNDv2-dR32zwie5:hover{color:"[theme:neutralSecondary, default:#605e5c]"}html[dir] ._1dKkLlfJNDv2-dR32zwie5:hover{background-color:"[theme:neutralLight, default:#edebe9]"}._1dKkLlfJNDv2-dR32zwie5:active{color:"[theme:neutralSecondary, default:#605e5c]"}html[dir] ._1dKkLlfJNDv2-dR32zwie5:active{background-color:"[theme:neutralQuaternaryAlt, default:#e1dfdd]"}._1dKkLlfJNDv2-dR32zwie5.CtfJt9OARiXa7wunCa-4m{color:"[theme:neutralSecondary, default:#605e5c]"}html[dir] ._1dKkLlfJNDv2-dR32zwie5.CtfJt9OARiXa7wunCa-4m{background-color:"[theme:themeLight, default:#C7E0F4]"}html[dir] ._1dKkLlfJNDv2-dR32zwie5.CtfJt9OARiXa7wunCa-4m:hover{background-color:"[theme:themeTertiary, default:#71AFE5]"}html[dir] ._1dKkLlfJNDv2-dR32zwie5.ms-Button{padding:0;border-width:0}._1dKkLlfJNDv2-dR32zwie5 ._3N3w1Wq3DBCKJtrO0a1D-U{width:32px}._1dKkLlfJNDv2-dR32zwie5 ._3N3w1Wq3DBCKJtrO0a1D-U._2lcUKsWqVDEyMDh9nKdQ2r{-webkit-filter:brightness(175%);filter:brightness(175%)}',""]),t.locals={popup:"_3f4MFgCmXZw5tsAxv_YZmy",userMarkupCalloutWrapper:"_2n2fxh7KEVUQ1c3qBZ0qfj",userMarkupPopupButton:"_1dKkLlfJNDv2-dR32zwie5",isChecked:"CtfJt9OARiXa7wunCa-4m",image:"_3N3w1Wq3DBCKJtrO0a1D-U",brightenIcons:"_2lcUKsWqVDEyMDh9nKdQ2r"}},18207:function(e,t,n){"use strict";n.r(t);var r=n(1),i=n(3979),a=n(2389),o=n(439),u=n(2539),c=n(2532),s=n(180);function l(e,t){var n=function(e,t){var n=Object(i.a)("UserHighlightData",t),r=Object(a.a)({Updates:[n],ItemId:Object(o.a)({Id:e})});return Object(u.a)({ItemChanges:[r],ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly"})}(e,t);return Object(c.a)({Header:Object(s.b)(),Body:n}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var d=n(4922),f=n(11556);function m(e,t,n,r,i){var a=function(a){var o=e.getClientRects();Ie(Object(f.a)(o,n),n,e,t,!r,r,null,i)};e.addEventListener("click",a),e[d.b]=a}var b=n(14),h=n(2),p={highlightIds:new b.ObservableMap},v=Object(h.createStore)("userHighlights",p)(),g=Object(h.mutatorAction)("addHighlightId",(function(e,t){var n=v.highlightIds;n.has(e)||n.set(e,t)})),O=n(4031),j=n(2484);function I(e){var t=e.indexOf(j.b),n=j.b.length+j.a;return e.substring(t,t+n)}var w=n(11967);function D(e,t,n){Object(O.a)(e,[n],(function(e){return function(n){!function(e){var t;return null===(t=null==e?void 0:e.parentElement)||void 0===t?void 0:t.classList.contains(w.userNote)}(n)?N(n,t,e):n.classList.add(j.d)}}),!1,"partially")}function N(e,t,n){e.classList.add(w.userHighlight),g(I(e.className),n),m(e,t,n,!1)}var y=n(121),k=Object(h.mutatorAction)("addUserHighlight",(function(e,t,n){var r=t.userHighlightData;r&&-1==r.indexOf(n)&&(r.push(n),l(t.ItemId.Id,r),D(e,t,n),Object(y.s)("UserMarkup_UserHighlightAdded"))}));function C(e){var t=e[d.b];t&&(e.removeEventListener("click",t),e[d.b]=null)}var x=Object(h.mutatorAction)("removeUserHighlight",(function(e,t){var n=I(e.className),i=v.highlightIds.get(n),a=t.userHighlightData,o=a&&a.indexOf(i),u=o>-1;u&&(a.splice(o,1),l(t.ItemId.Id,a),function(e,t){Object(r.c)(this,void 0,void 0,(function(){var n,i,a,o;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,Object(j.e)()];case 1:for(n=r.sent(),i=document.querySelectorAll("."+e),n.call(n,i).unmark({className:e}),a=0;a<i.length;a++)o=i[a],t(o);return[2]}}))}))}(n,C)),Object(y.s)("UserMarkup_UserHighlightRemoved",[!u])})),E=n(20),T=n(1260),_=n(1553),U=n(6),P=n(0),R=n.n(P),S=n(8360),F=n(7629),M=Object(E.a)((function(e){var t=e.selectedText,n=e.element,i=e.item,a=e.isForExistingUserHighlight,o=e.destroyPopupDivCallback;var u=R.a.useCallback((function(){k(n,i,t),window.getSelection().removeAllRanges(),o()}),[t,n,i,o]),c=R.a.useCallback((function(){x(n,i),o()}),[n,i,o]),s=a?{iconProps:{iconName:"Delete"},onClick:c}:{iconProps:{iconName:"Highlight"},onClick:u};return R.a.createElement(_.a,{hostClassName:F.userHighlightButtonWrapper,content:a?Object(U.b)(S.d):Object(U.b)(S.a)},R.a.createElement(T.a,Object(r.a)({className:F.UserMarkupPopupButton},s)))})),A=Object(h.mutatorAction)("setUserNoteData",(function(e,t){e.userNoteData=t})),H=n(5111),L=n(819);function J(e,t){var n=function(e,t){var n=Object(L.a)({ExtendedFieldURI:d.f,Value:JSON.stringify(t)}),r=Object(H.a)(n),i=Object(a.a)({Updates:[r],ItemId:Object(o.a)({Id:e})});return Object(u.a)({ItemChanges:[i],ConflictResolution:"AlwaysOverwrite",MessageDisposition:"SaveOnly"})}(e,t);return Object(c.a)({Header:Object(s.b)(),Body:n}).then((function(e){return e.Body.ResponseMessages.Items[0]}))}var K=n(11967);function q(e,t,n,r){e.classList.add(K.userNote),m(e,t,n,!0,r)}var V=Object(h.action)("addUserNote",(function(e,t,n,r,i,a){return{element:e,item:t,selectedText:n,instance:r,isExistingUserNote:i,stickyNoteId:a}}));Object(h.orchestrator)(V,(function(e){var t=e.element,n=e.item,r=e.selectedText,i=e.instance,a=e.isExistingUserNote,o={keyword:r,instance:i,stickyNoteId:e.stickyNoteId},u=n.userNoteData?n.userNoteData.slice():[];if(a)for(var c=0;c<u.length;c++){var s=u[c];if(s.instance==i&&s.keyword==r){u[c]=o;break}}else!function(e,t,n,r){Object(O.a)(e,[n],(function(e){return function(n,i){i==r?q(n,t,e,r):n.classList.add(j.d)}}),!1,"partially")}(t,n,r,i),u.push(o);A(n,u),J(n.ItemId.Id,u)}));var B=V;var W=n(744),z=n(3453),G=n(1426);function Q(e,t,n){var i,a;try{for(var o=Object(r.k)(n.userNoteData),u=o.next();!u.done;u=o.next()){var c=u.value;if(e===c.keyword&&t===c.instance)return c.stickyNoteId}}catch(e){i={error:e}}finally{try{u&&!u.done&&(a=o.return)&&a.call(o)}finally{if(i)throw i.error}}return null}var Z=n(4358),X=n(23),Y=n(7629);function $(e){var t;return Object(r.c)(this,void 0,void 0,(function(){var n,i,a;return Object(r.f)(this,(function(r){switch(r.label){case 0:return[4,z.g.import()];case 1:return n=r.sent(),[4,(i=n("NotesFeedFlexPane"))._ready];case 2:return r.sent(),[4,null===(t=i.notesSDK)||void 0===t?void 0:t.getNote(e)];case 3:return(a=r.sent())?i.openNote(a.id)?[2,!0]:(X.g.warn("[NoteOption] Failed to open note using note ID: "+a.id),[2,!1]):(X.g.warn("[NoteOption] Failed to get note using note ID: "+a.id),[2,!1])}}))}))}var ee=Object(E.a)((function(e){var t=this,n=e.target,i=e.selectedText,a=e.element,o=e.item,u=e.isForExistingUserNote,c=e.selectionRange,s=e.selectionInstance,l=e.destroyPopupDivCallback,d=R.a.useCallback((function(e){return Object(r.c)(t,void 0,void 0,(function(){return Object(r.f)(this,(function(t){switch(t.label){case 0:return[4,$(e)];case 1:return t.sent()&&(B(a,o,i,u?s:function(e,t,n){if(n.intersectsNode(t)){var r=document.createRange();r.setStartBefore(t),r.setEnd(n.startContainer,n.startOffset);var i=r.toString(),a=new RegExp(e,"gi"),o=i.match(a);return o?o.length:0}return-1}(i,a,c),u,e),Object(y.s)("NoteCreatedFromRP",{isCore:!0,excludeFromKusto:!0})),[2]}}))}))}),[a,o,i,s,u]),f=R.a.useCallback((function(){if(l(),Object(Z.c)("Honeybee"),u){$(Q(i,s,o))}else{var e=Object(W.a)(o.ItemId.Id),t=Object(G.a)(o.ItemId.Id);z.e.importAndExecute(i,e,t,o.Subject,"NotesFeedFlexPane",d)}}),[n,i,a,o,u,c,s,l]);return R.a.createElement(_.a,{content:u?Object(U.b)(S.g):Object(U.b)(S.b)},R.a.createElement(T.a,{className:Y.UserMarkupPopupButton,iconProps:u?{iconName:"View"}:{iconName:"EditNote"},onClick:f}))})),te=n(10122),ne=n(3544);function re(e){var t=Object(ne.a)(e);return Object(te.a)(t)}var ie=n(2447),ae=n(11551),oe=n(7629),ue=Object(E.a)((function(e){var t=e.selectedText,n=e.item,r=e.isForExistingUserHighlight,i=e.destroyPopupDivCallback,a=R.a.useCallback((function(){ie.h.importAndExecute(n.ItemId.Id,n.ConversationId.Id,t,0).then((function(){Object(y.s)("UserMarkup_ReplyWithQuote",[r?d.a:d.d])})),i()}),[t,n,r,i]),o=Object(ae.a)(n),u=re(n);return R.a.createElement(_.a,{content:o?Object(U.b)(S.e):Object(U.b)(S.f)},R.a.createElement(T.a,{className:oe.UserMarkupPopupButton,iconProps:{iconName:"Comment"},onClick:a,disabled:u}))})),ce=n(454),se=n(3299),le=n(7629),de=Object(E.a)((function(e){var t=e.selectedText,n=e.item,r=e.destroyPopupDivCallback,i=R.a.useCallback((function(){var e={initializePayload:{},actionPayload:{type:"switchListAndCreateTodos",todos:[{Subject:t,LinkedEmail:{Id:n.ItemId.Id,EntitySubtype:ce.d,DisplayName:t}}]}};se.h.importAndExecute("CreateTaskFromHighlight",e),Object(y.s)("UserMarkup_createTask"),r()}),[t,n,r]),a=re(n);return R.a.createElement(_.a,{content:Object(U.b)(S.c)},R.a.createElement(T.a,{className:le.UserMarkupPopupButton,iconProps:{iconName:"ToDoLogoOutline"},onClick:i,disabled:a}))})),fe=n(60);var me=n(1115),be=n(24),he=n(2363),pe=n(212),ve=n(7629),ge=Object(E.a)((function(e){var t=e.target,n=e.selectedText,r=e.element,i=e.item,a=e.isForExistingUserHighlight,o=e.isForExistingUserNote,u=e.selectionRange,c=e.selectionInstance;if(!i||!r||!n)return null;var s,l=!!i.RightsManagementLicenseData;return P.createElement(me.a,{isBeakVisible:!1,gapSpace:d.e,onDismiss:je,directionalHint:(s=n,s.length<d.c?fe.a.topCenter:fe.a.bottomCenter),target:t},P.createElement("div",{className:ve.userMarkupCalloutWrapper},Object(be.i)("rp-userMarkup")&&!o&&P.createElement(M,{selectedText:n,element:r,item:i,isForExistingUserHighlight:a,destroyPopupDivCallback:je}),Object(be.i)("rp-userMarkup")&&!a&&!l&&P.createElement(ee,{target:t,selectedText:n,element:r,item:i,isForExistingUserNote:o,selectionRange:u,selectionInstance:c,destroyPopupDivCallback:je}),P.createElement(ue,{selectedText:n,item:i,isForExistingUserHighlight:a,destroyPopupDivCallback:je}),Object(he.c)()&&P.createElement(de,{selectedText:n,item:i,destroyPopupDivCallback:je})))})),Oe=null;function je(){Oe&&(pe.unmountComponentAtNode(Oe),Oe.parentNode.removeChild(Oe),Oe=null)}var Ie=function(e,t,n,r,i,a,o,u){Oe||(Oe=document.createElement("div"),document.body.appendChild(Oe)),pe.render(P.createElement(P.StrictMode,null,P.createElement(ge,{target:e,selectedText:t,element:n,item:r,isForExistingUserHighlight:i,isForExistingUserNote:a,selectionRange:o,selectionInstance:u})),Oe),Object(y.s)("UserMarkup_PopupShown",[i?d.a:d.d])};function we(e,t,n,r,i){var a;i&&(i.isNote&&(null===(a=i.noteInstances)||void 0===a?void 0:a.has(r))?q(e,t,n,r):i.isHighlight?N(e,t,n):i.isNote&&e.classList.add(j.d))}var De=n(4309),Ne=n(10124);function ye(e){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,ke(e)];case 1:return t=n.sent()||[],Ce(e,t),[2]}}))}))}function ke(e){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:t=null,n.label=1;case 1:return n.trys.push([1,4,,5]),[4,De.c.import()];case 2:return[4,n.sent()(e.ItemId.Id,Ne.b)];case 3:return t=n.sent(),[3,5];case 4:return n.sent(),[3,5];case 5:return t?[2,t.UserHighlightData]:[2,null]}}))}))}var Ce=Object(h.mutatorAction)("setUserHighlightDataForItem",(function(e,t){e.userHighlightData=t})),xe=n(10125),Ee=n(3681);function Te(e){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return[4,_e(e)];case 1:return t=n.sent()||[],Ue(e,t),[2]}}))}))}function _e(e){return Object(r.c)(this,void 0,void 0,(function(){var t,n;return Object(r.f)(this,(function(r){switch(r.label){case 0:t=null,r.label=1;case 1:return r.trys.push([1,4,,5]),[4,De.c.import()];case 2:return[4,r.sent()(e.ItemId.Id,xe.c)];case 3:return t=r.sent(),[3,5];case 4:return r.sent(),[3,5];case 5:return t?[2,(n=Object(Ee.a)(t,null,xe.a))?JSON.parse(n):null]:[2,null]}}))}))}var Ue=Object(h.mutatorAction)("setUserNoteDataForItem",(function(e,t){e.userNoteData=t}));function Pe(e){return Object(r.c)(this,void 0,void 0,(function(){var t;return Object(r.f)(this,(function(n){switch(n.label){case 0:return t={userHighlightData:null,userNoteData:null},e?e.userHighlightData?[3,2]:[4,ye(e)]:[3,5];case 1:n.sent(),n.label=2;case 2:return t.userHighlightData=e.userHighlightData,e.userNoteData?[3,4]:[4,Te(e)];case 3:n.sent(),n.label=4;case 4:t.userNoteData=e.userNoteData,n.label=5;case 5:return[2,t]}}))}))}function Re(e,t){var n=[];return e.forEach((function(e){return n.push(e)})),t.forEach((function(e){var t=e.keyword;-1==n.indexOf(t)&&n.push(t)})),n}function Se(e,t){var n=new Map;return e.forEach((function(e){n.set(e,{isHighlight:!0,isNote:!1})})),t.forEach((function(e){var t=e.keyword,r=e.instance,i=n.get(t),a=(null==i?void 0:i.noteInstances)||new Set;a.add(r),i?(i.isNote=!0,i.noteInstances=a):i={isHighlight:!1,isNote:!0,noteInstances:a},n.set(t,i)})),n}n.d(t,"showUserMarkupPopup",(function(){return Ie})),n.d(t,"destroyPopupDiv",(function(){return je})),n.d(t,"markInstanceOfUserMarkup",(function(){return we})),n.d(t,"removeUserMarkupPopupEventListener",(function(){return C})),n.d(t,"getItemUserMarkupData",(function(){return Pe})),n.d(t,"getItemUserMarkupKeywords",(function(){return Re})),n.d(t,"getItemUserMarkupMap",(function(){return Se}))},2239:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"Message:#Exchange"},e)}},2363:function(e,t,n){"use strict";var r=n(2),i=Object(r.action)("openTimePanel",(function(e){return{source:e}})),a=Object(r.action)("handleTimePanelClosed",(function(e,t,n,r){return{source:e,sessionDuration:t,lastView:n,clientItemId:r}})),o=Object(r.action)("popView"),u=n(514);function c(){return!Object(u.w)()||!window.opener}var s=n(2572);function l(){return c()&&Object(s.a)("Tasks")}n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return a})),n.d(t,"e",(function(){return o})),n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return l}))},2374:function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return a}));var r=n(2),i=Object(r.action)("NEW_MESSAGE_V3",(function(e,t,n,r,i){return{actionSource:e,groupId:t,toEmailAddressWrappers:n,subject:r,body:i}})),a=Object(r.action)("ON_CLOSE_COMPOSE",(function(e){return{closeReason:e}}))},2389:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"ItemChange:#Exchange"},e)}},2421:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"SetItemField:#Exchange"},e)}},2447:function(e,t,n){"use strict";var r=n(2),i=n(2374);Object(r.orchestrator)(i.a,(function(e){c.importAndExecute(e.actionSource,e.groupId,e.toEmailAddressWrappers,e.subject,e.body)}));var a=n(2834),o=(Object(r.orchestrator)(a.a,(function(e){var t=e.source,n=e.groupId,r=e.toRecipients,a=e.subject,o=e.body;Object(i.a)(t,n,r,a,o)})),n(31));n.d(t,"c",(function(){return c})),n.d(t,"f",(function(){return s})),n.d(t,"a",(function(){return l})),n.d(t,"d",(function(){return d})),n.d(t,"g",(function(){return f})),n.d(t,"b",(function(){return m})),n.d(t,"e",(function(){return b})),n.d(t,"i",(function(){return h})),n.d(t,"h",(function(){return p}));var u=new o.c((function(){return Promise.all([n.e(26),n.e(29),n.e(43),n.e(41),n.e(716)]).then(n.bind(null,18291))})),c=new o.a(u,(function(e){return e.newMessage}),{captureBundleTime:!0}),s=new o.a(u,(function(e){return e.replyToConversation})),l=new o.a(u,(function(e){return e.forwardConversation})),d=new o.a(u,(function(e){return e.printConversation})),f=new o.a(u,(function(e){return e.replyToItem})),m=new o.a(u,(function(e){return e.forwardItem})),b=new o.a(u,(function(e){return e.printItem})),h=new o.a(u,(function(e){return e.showConversationInImmersiveReader})),p=new o.a(u,(function(e){return e.replyWithText}))},2479:function(e,t,n){"use strict";var r=n(1),i={abovePanelHeight:n(2820).b,initialPanelView:"Calendar",initialCalendarView:"Agenda",areFREsDisabled:!1,isFullComposeEnabled:!1,isClosePaneButtonEnabled:!1,isTasksViewDisabled:!1};function a(e){i=Object(r.a)({},e)}function o(){return i}n.d(t,"b",(function(){return a})),n.d(t,"a",(function(){return o}))},2532:function(e,t,n){"use strict";var r=n(33),i=n(1);function a(e,t){var n;return void 0===e||e.__type||(n=e,e=Object(i.a)({__type:"UpdateItemJsonRequest:#Exchange"},n)),Object(r.a)("UpdateItem",e,t)}n.d(t,"a",(function(){return a}))},2539:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"UpdateItemRequest:#Exchange"},e)}},2572:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2648),i=n(2479),a=n(2166);function o(e){return"Tasks"!==Object(r.a)(e)||Object(a.c)()&&!Object(i.a)().isTasksViewDisabled}},2648:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r={Conflicts:"Calendar",EventDetails:"Calendar",AttendeeTracking:"Calendar",Calendar:"Calendar",ComposeForm:"Calendar",Tasks:"Tasks",TaskDetails:"Tasks"};function i(e){return e?r[e]:null}},2820:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return i}));var r=48,i=65},2834:function(e,t,n){"use strict";var r=n(2);t.a=Object(r.action)("createFeedbackForCortana",(function(e,t,n,r,i){return{source:e,groupId:t,toRecipients:n,subject:r,body:i}}))},3299:function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return u})),n.d(t,"d",(function(){return c})),n.d(t,"f",(function(){return s})),n.d(t,"h",(function(){return l})),n.d(t,"i",(function(){return d})),n.d(t,"e",(function(){return f})),n.d(t,"c",(function(){return m})),n.d(t,"g",(function(){return b}));var r=n(2363),i=n(31),a=new i.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(7),n.e(16),n.e(22),n.e(28),n.e(31),n.e(40),n.e(53),n.e(59),n.e(87),n.e(187),n.e(310),n.e(1042)]).then(n.bind(null,4495))}));Object(i.f)(r.d,a,(function(e){return e.openTimePanelOrchestrator}));var o=Object(i.d)(a,(function(e){return e.TimePanel})),u=Object(i.d)(a,(function(e){return e.TimePanelHeaderBar})),c=new i.a(a,(function(e){return e.loadTimePanelData})),s=new i.a(a,(function(e){return e.openEventDetailsView})),l=(new i.a(a,(function(e){return e.openAttendeeTrackingView})),new i.a(a,(function(e){return e.closeAttendeeTrackingView})),new i.a(a,(function(e){return e.openTasksView}))),d=new i.a(a,(function(e){return e.openCalendarView})),f=new i.a(a,(function(e){return e.openConflictsView})),m=new i.a(a,(function(e){return e.closeConflictsView})),b=new i.a(a,(function(e){return e.openEventQuickComposeView}))},3308:function(e,t,n){"use strict";var r=n(2),i=Object(r.createStore)("notesStore",{isPanelInitialized:!1,isPanelOpen:!1,sessionId:void 0,panelOpenTimestamp:void 0,source:void 0,selectedNoteId:void 0,selectedNoteColor:void 0});t.a=i},3453:function(e,t,n){"use strict";n.d(t,"g",(function(){return o})),n.d(t,"c",(function(){return u})),n.d(t,"e",(function(){return c})),n.d(t,"d",(function(){return s})),n.d(t,"f",(function(){return l})),n.d(t,"b",(function(){return d})),n.d(t,"h",(function(){return f}));var r=n(31),i=n(3308);n.d(t,"a",(function(){return i.a}));var a=new r.c((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(4),n.e(16),n.e(22),n.e(30),n.e(33),n.e(35),n.e(36),n.e(39),n.e(44),n.e(51),n.e(52),n.e(62),n.e(83),n.e(96),n.e(106),n.e(162),n.e(198),n.e(197),n.e(293),n.e(759),n.e(968)]).then(n.bind(null,5742))})),o=new r.b(a,(function(e){return e.getNotesSDK})),u=new r.b(a,(function(e){return e.ContextType})),c=new r.a(a,(function(e){return e.createNoteFromMessageData})),s=new r.a(a,(function(e){return e.createNewNote})),l=new r.a(a,(function(e){return e.deleteNote})),d=new r.a(a,(function(e){return e.changeNoteColor})),f=new r.a(a,(function(e){return e.viewEmailFromNote}))},3979:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(2239),i=n(979),a=n(2421);function o(e,t){var n;return Object(a.a)({Path:Object(i.a)({FieldURI:e}),Item:Object(r.a)((n={},n[e]=t,n))})}},4358:function(e,t,n){"use strict";var r=n(31),i=n(2),a=Object(i.action)("openOneNoteFeedPanel",(function(e){return{source:e}})),o=Object(i.action)("handleOneNoteFeedPanelClosed",(function(e,t){return{source:e,sessionDuration:t}}));n.d(t,"b",(function(){return c})),n.d(t,"c",(function(){return a})),n.d(t,"a",(function(){return o}));var u=new r.c((function(){return Promise.all([n.e(4),n.e(956)]).then(n.bind(null,18437))})),c=new r.a(u,(function(e){return e.initializeOneNoteFeed}))},454:function(e,t,n){"use strict";var r,i="dragged_email";!function(e){e.Normal="Normal",e.High="High",e.Low="Low"}(r||(r={}));var a=r;function o(e){return"Todo"===(null==e?void 0:e.__type)}var u=n(1),c=n(203);function s(e){return e=null!==e?e:{},Object(u.a)(Object(u.a)({},e),{CompletedDateTime:e.CompletedDateTime?e.CompletedDateTime:null,Id:e.Id?e.Id:Object(c.a)(),IsCompleted:!!e.IsCompleted&&e.IsCompleted,OrderDateTime:e.OrderDateTime?e.OrderDateTime:null,Subject:e.Subject?e.Subject:null})}function l(e){var t=(e=null!==e?e:{}).Id?e.Id:Object(c.a)();return Object(u.a)(Object(u.a)({},e),{__type:"Todo",Id:t,ParentFolderId:e.ParentFolderId?e.ParentFolderId:null,Subject:e.Subject?e.Subject:null,ReminderDateTime:e.ReminderDateTime?e.ReminderDateTime:null,IsReminderOn:!!e.IsReminderOn&&e.IsReminderOn,CompletedDateTime:e.CompletedDateTime?e.CompletedDateTime:null,DueDateTime:e.DueDateTime?e.DueDateTime:null,OrderDateTime:e.OrderDateTime?e.OrderDateTime:null,Status:e.Status?e.Status:"NotStarted",Subtasks:e.Subtasks?e.Subtasks:null,Importance:e.Importance?e.Importance:a.Normal,Note:e.Note?e.Note:null,LinkedEmail:e.LinkedEmail?e.LinkedEmail:null,CommittedDay:e.CommittedDay?e.CommittedDay:null,CommittedOrder:e.CommittedOrder?e.CommittedOrder:null,CreatedWithLocalId:t})}function d(e){return e=null!==e?e:{},Object(u.a)(Object(u.a)({},e),{Id:e.Id?e.Id:Object(c.a)(),Name:e.Name?e.Name:null,IsDefaultFolder:!!e.IsDefaultFolder&&e.IsDefaultFolder,IsSharedFolder:!!e.IsSharedFolder&&e.IsSharedFolder,IsOwner:!!e.IsOwner&&e.IsOwner,FolderType:e.FolderType?e.FolderType:"Other",SyncStatus:e.SyncStatus?e.SyncStatus:"Synced",OrderDateTime:e.OrderDateTime?e.OrderDateTime:null})}function f(e){return e&&e.subjects&&0!==e.subjects.length?e.subjects.map((function(t,n){return{Subject:t,LinkedEmail:{Id:e.latestItemIds[n],EntitySubtype:i,DisplayName:t}}})):[]}n.d(t,"c",(function(){return"message"})),n.d(t,"b",(function(){return i})),n.d(t,"d",(function(){return"highlight_from_email"})),n.d(t,"a",(function(){return"context_menu_email"})),n.d(t,"e",(function(){return a})),n.d(t,"j",(function(){return o})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return d})),n.d(t,"i",(function(){return f}))},5111:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(819),i=n(449),a=n(2239),o=n(2421);function u(e){return Object(o.a)({Path:Object(i.a)(e.ExtendedFieldURI),Item:Object(a.a)({ExtendedProperty:[Object(r.a)(e)]})})}},744:function(e,t,n){"use strict";function r(e){if(!e)return e;var t=e.replace(/\+/g,"_");return t=t.replace(/\//g,"-")}function i(e){if(!e)return e;var t=e.replace(/_/g,"+");return t=t.replace(/-/g,"/")}n.d(t,"a",(function(){return r})),n.d(t,"b",(function(){return i}))},7629:function(e,t,n){var r=n(16979),i=n(78);"string"==typeof r&&(r=[[e.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(e.exports=r.locals)},7630:function(e,t,n){"use strict";function r(e){return(null==e?void 0:e.MailboxInfo)&&"GroupMailbox"==e.MailboxInfo.type}n.d(t,"a",(function(){return r}))},819:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1);function i(e){return Object(r.a)({__type:"ExtendedPropertyType:#Exchange"},e)}},8360:function(e){e.exports=JSON.parse('{"a":"Qec","b":"Rec","g":"Sec","e":"Tec","f":"Uec","d":"Vec","c":"Wec"}')}}]);
//# sourceMappingURL=owa.MailBoot~UserHighlighting.js.map
self.scriptsLoaded['owa.MailBoot~UserHighlighting.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~UserHighlighting.js'] = (new Date()).getTime();