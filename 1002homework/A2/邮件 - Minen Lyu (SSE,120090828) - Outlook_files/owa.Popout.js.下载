self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Popout.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[982],{12630:function(t){t.exports=JSON.parse('{"c":"uta","b":"vta","a":"wta"}')},18279:function(t,e,n){"use strict";n.r(e);var o=n(1),r=n(709),a=n(23),c={popouts:[]};function i(t){var e;return Object(o.c)(this,void 0,void 0,(function(){var n,i,u;return Object(o.f)(this,(function(o){switch(o.label){case 0:if(!(n=Object(r.b)(t)))return[3,7];switch(i=function(t){return c.popouts.filter((function(e){try{return e.window==t.source}catch(t){return!1}}))[0]}(t),n.type){case r.a.PopoutReady:return[3,1];case r.a.CloseWindow:return[3,4];case r.a.DeeplinkReady:return[3,5]}return[3,6];case 1:return u=null,i?[4,i.dataCallback()]:[3,3];case 2:u=o.sent(),o.label=3;case 3:try{Object(r.c)(t.source,r.a.SetData,u)}catch(t){a.g.warn("Fail to reply message to child window: "+t)}return[3,7];case 4:try{t.source.close()}catch(t){a.g.warn("Failed to close child window: "+t)}return[3,7];case 5:return null===(e=null==i?void 0:i.datapoint)||void 0===e||e.end(),[3,7];case 6:return[3,7];case 7:return[2]}}))}))}var u=!1;var d=n(988);function s(t,e){if(t)try{var n=e.document,o=n.createElement("STYLE");o.innerHTML=t,n.head.appendChild(o)}catch(t){a.d}}var l="data-merge-styles",b="true";function f(t){var e="";if(null==t?void 0:t.sheet){var n=t.sheet;if(t.getAttribute(l)==b)for(var o=0;o<n.rules.length;o++){e+=n.rules[o].cssText}else e=t.innerHTML}return e}var v=n(118),p=n(8960),w={childList:!0},j=!1;function h(){j||(v.b.getInstance().setConfig({onInsertRule:O}),new MutationObserver(m).observe(document.head,w),window.addEventListener("unload",(function(){d.a.projections.forEach((function(t){var e={redirectUrl:null};Object(p.a)(t.tabId,e);try{e.redirectUrl?t.window.location.href=e.redirectUrl:t.window.close()}catch(t){}}))})),j=!0)}function O(t){d.a.projections.forEach((function(e){s(t,e.window)}))}function m(t){var e="";t.forEach((function(t){if("childList"==t.type)for(var n=t.addedNodes,o=0;o<n.length;o++){var r=n[o];"STYLE"==r.tagName&&(e+=f(r))}})),d.a.projections.forEach((function(t){s(e,t.window)}))}var y=n(6),g=n(19),P=n(2),E=Object(P.action)("Popout_RemoveProjection",(function(t){return{window:t}})),I=n(12630),T=n(817),L=n(2269),C=n(8961),S="<!doctype html>";function M(t,e){var n=function(t){var e=document.body.parentNode.cloneNode(),n=document.createElement("head"),o=document.createElement("title");o.innerText=function(t){var e="";switch(t){case"mail":e=Object(y.b)(I.b);break;case"calendar":e=Object(y.b)(I.a)}return Object(y.c)(Object(y.b)(I.c),e,Object(g.a)().SessionSettings.UserDisplayName)}(t),n.appendChild(o);var r=document.createElement("body");r.style.minWidth="auto";var a=document.createElement("div");return a.id=T.c,a.style.width="100%",a.style.height="100%",e.appendChild(n),e.appendChild(r),r.appendChild(a),S+e.outerHTML}(t);try{e.document.write(n),function(t,e){for(var n=t.getElementsByTagName("style"),o=0;o<n.length;o++){s(f(n[o]),e)}}(document,e)}catch(t){a.d("Fail to write HTML for projection: "+t)}e.addEventListener("unload",(function(){return function(t){E(t)}(e)})),e.addEventListener("blur",(function(){return function(t){var e=Object(L.a)(t);(null==e?void 0:e.tabId)&&Object(C.a)(e.tabId)}(e)}))}var k=Object(P.mutatorAction)("Popout_AddDeeplink",(function(t,e,n){c.popouts.push({window:t,dataCallback:e,datapoint:n})})),N=n(14),_=Object(P.mutatorAction)("Popout_AddProjection",(function(t,e,n){Object(d.b)().projections.push({window:t,tabId:e,datapoint:n,underlay:{isShown:new N.ObservableMap,shrinkable:new N.ObservableMap},flexPane:{isShown:!1,activePaneCount:0,isExternalHide:!1}})})),A=n(7083),x=n(8962);function H(t,e,n,o,r){if(n){var a=Object(L.a)(e);a&&a.tabId!=n?Object(x.a)(a.tabId,n):(M(t,e),h(),_(e,n,r),Object(A.a)(n,e))}else u||(window.addEventListener("message",i),u=!0),k(e,o,r)}var R=n(8963);Object(P.orchestrator)(E,(function(t){for(var e=t.window,n=Object(d.b)(),o=0;o<n.projections.length;o++)if(n.projections[o].window==e){Object(R.a)(n.projections[o].tabId),D(o);break}}));var D=Object(P.mutatorAction)("removeProjectionFromStore",(function(t){Object(d.b)().projections.splice(t,1)}));n.d(e,"bootPopout",(function(){return H}))},2269:function(t,e,n){"use strict";n.d(e,"a",(function(){return r}));var o=n(988);function r(t){var e;return null===(e=o.a.projections)||void 0===e?void 0:e.filter((function(e){return e.tabId==t||e.window==t}))[0]}},7083:function(t,e,n){"use strict";var o=n(2),r=Object(o.action)("StartProjection",(function(t,e){return{tabId:t,targetWindow:e}}));e.a=r},8960:function(t,e,n){"use strict";var o=n(2),r=Object(o.action)("Popout_BeforeCloseMainWindow",(function(t,e){return{tabId:t,param:e}}));e.a=r},8961:function(t,e,n){"use strict";var o=n(2),r=Object(o.action)("Popout_OnProjectionBlur",(function(t){return{tabId:t}}));e.a=r},8962:function(t,e,n){"use strict";var o=n(2),r=Object(o.action)("Popout_TransferProjectionTab",(function(t,e){return{oldTabId:t,newTabId:e}}));e.a=r},8963:function(t,e,n){"use strict";var o=n(2),r=Object(o.action)("Popout_OnRemoveProjection",(function(t){return{tabId:t}}));e.a=r}}]);
//# sourceMappingURL=owa.Popout.js.map
self.scriptsLoaded['owa.Popout.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Popout.js'] = (new Date()).getTime();