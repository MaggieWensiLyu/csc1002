self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~SharedFolders.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[817],{10450:function(e,t,r){"use strict";var n=r(8238),o=r(8239),i=r(2007),a=r(2),c=(Object(a.mutator)(n.b,(function(e){Object(o.b)().userMailboxWrapper=e.userMailboxWrapper})),Object(a.mutator)(n.a,(function(){var e=Object(o.b)();e.userMailboxWrapper=null,e.findControlViewState={queryString:"",findResultSet:[],findResultType:i.b.None,isSearching:!1,directorySearchType:i.a.None,findPeopleFeedbackManager:null,numberOfCacheResults:0}})),r(31));r.d(t,"a",(function(){return u}));var s=new c.c((function(){return Promise.all([r.e(5),r.e(7),r.e(23),r.e(48),r.e(66),r.e(71),r.e(768)]).then(r.bind(null,18538))})),u=Object(c.d)(s,(function(e){return e.PeoplePickerDialog}))},14598:function(e){e.exports=JSON.parse('{"a":"bEb"}')},14599:function(e){e.exports=JSON.parse('{"a":"$Db"}')},2007:function(e,t,r){"use strict";var n,o;r.d(t,"b",(function(){return n})),r.d(t,"a",(function(){return o})),function(e){e[e.None=0]="None",e[e.Cache=1]="Cache",e[e.FindPeople=2]="FindPeople",e[e.SearchDirectory=3]="SearchDirectory",e[e.MixedCacheLive=4]="MixedCacheLive"}(n||(n={})),function(e){e[e.None=0]="None",e[e.Auto=1]="Auto",e[e.Manual=2]="Manual"}(o||(o={}))},2794:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i}));var n=r(2),o=Object(n.action)("ON_FILES_FOLDER_SHOWN",(function(e){return{isExpanded:e}})),i=Object(n.action)("FILES_TREE_ROOT_NODE_CLICKED",(function(e){return{isExpanded:e}}))},3382:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n="filesFolderId"},3552:function(e,t,r){"use strict";var n=r(2);t.a=Object(n.action)("EMPTY_FOLDER_STORE_UPDATE",(function(e,t,r,n){return{folderId:e,clientLastSyncTime:t,deletedItemsFolderId:r,rowKeysToExclude:n}}))},3939:function(e,t,r){"use strict";var n=r(2),o=Object(n.action)("setFolderSortBy",(function(e,t,r){return{folderId:e,sortColumn:t,sortDirection:r}}));t.a=o},4148:function(e,t,r){"use strict";var n=r(2794),o=r(3939),i=r(4400),a=r(31),c=r(3552),s=r(2423),u=r(731);function d(e,t){return Object(u.b)(e,t,!1,{hideCancelButton:!0})}var l=r(1),b=r(3215),f=r(2657),O=r(2159),h=r(1984),j=r(3809),p=r(19),S=r(1244),v=r(1951),m=r(197);function y(e,t){if(t==Object(S.a)("msgfolderroot"))return!Object(p.a)().UserOptions.IsMailRootFolderTreeCollapsed;var r=e[t];return!r||r.IsExpanded}function F(){return Object(l.c)(this,void 0,void 0,(function(){return Object(l.f)(this,(function(e){switch(e.label){case 0:return[4,Object(v.w)()];case 1:return e.sent(),Object(m.a)()||(Object(p.a)().SessionSettings.HasArchive&&Object(v.A)(),Object(v.B)()),t=Object(b.c)(),Object.keys(t).forEach((function(e){var r=Object(f.a)(e),n=r.sortColumn,o=r.sortDirection,i={isExpanded:y(t,e),sortColumn:n,sortOrder:o,drag:Object(O.a)(),drop:Object(h.a)()};Object(j.a)(e,i)})),[2]}var t}))}))}var E=r(3382),I=r(3147),g=r(2),x=r(4210),A=(Object(g.orchestrator)(x.a,(function(e){F()})),r(3938));Object(g.orchestrator)(n.b,(function(){Object(A.a)(E.a)}));r.d(t,"b",(function(){return _})),r.d(t,"g",(function(){return d})),r.d(t,"e",(function(){return n.b})),r.d(t,"d",(function(){return n.a})),r.d(t,"c",(function(){return F})),r.d(t,"a",(function(){return E.a})),r.d(t,"f",(function(){return o.a}));var M=new a.c((function(){return r.e(923).then(r.bind(null,18319))}));Object(a.f)(i.a,M,(function(e){return e.onNewFolderSuccessOrchestrator})),Object(a.f)(n.a,M,(function(e){return e.onFilesFolderShownOrchestrator})),Object(a.f)(I.a,M,(function(e){return e.onNewFolderRowNotificationOrchestrator})),Object(a.f)(s.a,M,(function(e){return e.markAllAsReadOrchestrator})),Object(a.f)(c.a,M,(function(e){return e.emptyFolderStoreUpdateOrchestrator})),Object(a.f)(o.a,M,(function(e){return e.setFolderSortByOrchestrator}));var _=new a.a(M,(function(e){return e.dismissMailFolderTextField}))},419:function(e,t,r){"use strict";var n=r(1);function o(e,t){return e?Object(n.a)({mailboxInfo:e},t):null!=t?t:void 0}r.d(t,"a",(function(){return o}))},4210:function(e,t,r){"use strict";var n=r(2);t.a=Object(n.action)("SELECT_CATEGORIES_OPTIONS")},4400:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2),o=Object(n.action)("onNewFolderSuccess",(function(e,t,r){return{folderId:e,parentFolderId:t,displayName:r}}))},5207:function(e){e.exports=JSON.parse('{"a":"aEb"}')},5479:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(1951),o=r(57);function i(e){return e||(e=Object(o.b)()),Object(n.t)(e).sharedFolderUserEmails}},6144:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return a}));var n=r(9),o=new n.b((function(){return r.e(965).then(r.bind(null,10106))})),i=new n.c(o,(function(e){return e.FolderHierarchyDocument})),a=new n.c(o,(function(e){return e.PrimaryFolderHierarchyDocument}))},6162:function(e){e.exports=JSON.parse('{"a":"SDa"}')},6766:function(e,t,r){"use strict";r.r(t);var n=r(20),o=r(14598),i=r(5207),a=r(6),c=r(10450),s=r(0),u=r(7413),d=r(1),l=r(14599),b=r(2),f=Object(b.action)("ADD_SHARED_FOLDER_USER_EMAIL",(function(e,t){return{sharedUserMailboxSmtpAddress:e,userIdentity:t}})),O=Object(b.action)("ON_ADD_SHARED_FOLDER_SUCCESS",(function(e,t,r){return{sharedUserMailboxSmtpAddress:e,folder:t,userIdentity:r}})),h=r(33);function j(e,t){return r={displayName:e,primarySMTPAddress:t},Object(h.a)("AddSharedFolders",r,n);var r,n}var p=r(121),S=r(731),v=r(6162),m=r(23),y=r(57);function F(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=Object(y.b)()),Object(d.c)(this,void 0,void 0,(function(){var o;return Object(d.f)(this,(function(i){switch(i.label){case 0:return i.trys.push([0,3,,4]),r?[3,2]:[4,j(e,t)];case 1:if(!i.sent())return[2];i.label=2;case 2:return[3,4];case 3:return o=i.sent(),Object(S.b)(Object(a.b)(v.a),Object(a.b)(l.a),!1,{hideCancelButton:!0}),m.d("Add shared folder API returned error "+o),[2];case 4:return O(t,{FolderId:{Id:t},DisplayName:e,principalSMTPAddress:t,UnreadCount:0,TotalCount:0,DistinguishedFolderId:void 0,mailboxInfo:{type:"SharedMailbox",userIdentity:n,mailboxSmtpAddress:t}},n),f(t,n),r||Object(p.s)("Triage_SharedFolders_AddFolder"),[2]}}))}))}var E=Object(b.action)("showAddSharedFolderDialog",(function(e){return{showDialogMessageFlag:e}})),I=Object(n.a)((function(){return u.a.showPeoplePickerDialog&&s.createElement(c.a,{title:Object(a.b)(i.a),subTitle:Object(a.b)(o.a),addCallback:g,cancelCallback:x})}));function g(e){F(e.Name,e.EmailAddress)}function x(){E(!1)}var A=Object(b.action)("REMOVE_SHARED_FOLDER_USER",(function(e,t){return t||(t=Object(y.b)()),{sharedUserMailboxSmtpAddress:e,userIdentity:t}})),M=r(5479),_=Object(b.action)("REMOVE_SHARED_FOLDER_USER_EMAIL",(function(e,t){return{sharedUserMailboxSmtpAddress:e,userIdentity:t}})),R=(Object(b.mutator)(_,(function(e){var t=Object(M.a)(e.userIdentity),r=t.indexOf(e.sharedUserMailboxSmtpAddress);-1!==r?t.splice(r,1):m.d("Trying to remove a non-existent shared folder user : "+e.sharedUserMailboxSmtpAddress)})),Object(b.mutator)(f,(function(e){var t=Object(M.a)(e.userIdentity);-1==t.indexOf(e.sharedUserMailboxSmtpAddress)&&t.push(e.sharedUserMailboxSmtpAddress)})),Object(b.mutator)(E,(function(e){Object(u.b)().showPeoplePickerDialog=e.showDialogMessageFlag})),r(1951));Object(b.orchestrator)(O,(function(e){var t={};t[e.sharedUserMailboxSmtpAddress]=e.folder,Object(R.b)(t),Object(R.U)(e.sharedUserMailboxSmtpAddress,e.folder,R.a.Uninitialized,!0,0,e.userIdentity)}));var D=Object(b.action)("ON_SHARED_FOLDER_FETCH_FAILED",(function(e,t){return{sharedUserMailboxSmtpAddress:e,actionSource:t}})),T=r(44),w=r(8180),P=r(1959),C=r(1250),N=r(6144),U=Object(b.action)("INITIALIZE_SHARED_FOLDER_RETENTION_POLICY_TAGS",(function(e,t){return{sharedUserMailboxSmtpAddress:e,userIdentity:t}}));Object(b.orchestrator)(w.a,(function(e){return Object(d.c)(void 0,void 0,void 0,(function(){var t,r,n,o,i,a,c,s,u,l,b,f,O;return Object(d.f)(this,(function(h){switch(h.label){case 0:if(t=e.userIdentity,r=e.sharedUserMailboxSmtpAddress,n=e.actionSource,o=e.isLoadingMore,(i=Object(R.q)(r,t))===R.a.Loading||i===R.a.Loaded&&!o)return[2];Object(R.V)(r,R.a.Loading,t),c=Object(R.o)(r,t),h.label=1;case 1:return h.trys.push([1,4,,5]),[4,Promise.all([Object(C.a)(),N.a.import()])];case 2:return s=d.g.apply(void 0,[h.sent(),2]),u=s[0],l=s[1],[4,u.query({query:l,variables:{baseFolderDistinguishedIds:[P.l,"inbox"],indexedPageOffset:c,mailboxInfo:{userIdentity:t,mailboxSmtpAddress:r,type:"SharedMailbox"},shouldPopulateChildFolderIds:!1}})];case 3:return b=h.sent(),a=b.data.folderHierarchy,[3,5];case 4:return f=h.sent(),Object(p.s)("SharedFolders_FetchFailed",[f.ResponseCode,f.diagnosticInfo],{isCore:!0}),D(r,n),Object(R.V)(r,R.a.ErrorLoading,t),[2];case 5:return O=Object(R.x)(r).DisplayName,Object(R.Q)(a.RootFolder,a.Folders,P.l,r,O,r,t,a.IncludesLastItemInRange,a.IndexedPagingOffset),0===c&&U(r,t),j=a.TotalItemsInView,Object(p.s)("Triage_SharedFolders_OpenFolder",[Object(T.e)({value:j})]),[2]}var j}))}))}));var L=r(7419),k=r(4148),H=r(3938);function B(e){return t={primarySMTPAddress:e},Object(h.a)("RemoveSharedFolders",t,r);var t,r}Object(b.orchestrator)(D,(function(e){Object(k.g)(Object(a.b)(v.a),Object(a.b)(L.a)),"folderPane"===e.actionSource&&Object(H.a)(e.sharedUserMailboxSmtpAddress,!1)}));Object(b.orchestrator)(A,(function(e){return Object(d.c)(void 0,void 0,void 0,(function(){var t,r,n,o;return Object(d.f)(this,(function(i){switch(i.label){case 0:t=e.sharedUserMailboxSmtpAddress,r=e.userIdentity,i.label=1;case 1:return i.trys.push([1,3,,4]),[4,B(t)];case 2:return n=i.sent(),[3,4];case 3:return o=i.sent(),m.d("Remove shared folders server call failed with error "+o),[3,4];case 4:return n?(_(t,r),Object(R.T)(t,r),Object(p.s)("Triage_SharedFolders_RemoveFolder")):m.d("Remove shared folders server call returned false"),[2]}}))}))}));function V(e,t){var r;return void 0===e||e.__type||(r=e,e=Object(d.a)({__type:"GetUserRetentionPolicyTagsJsonRequest:#Exchange"},r)),Object(h.a)("GetUserRetentionPolicyTags",e,t)}var q=r(180),z=r(419);var G=Object(b.mutatorAction)("setPolicyTags",(function(e,t){Object(u.b)().retentionPolicyTags.set(e,t)}));function J(){return e={},Object(h.a)("GetOtherMailboxConfiguration",e,t);var e,t}Object(b.orchestrator)(U,(function(e){return Object(d.c)(void 0,void 0,void 0,(function(){var t,r,n,o,i;return Object(d.f)(this,(function(a){switch(a.label){case 0:t=e.sharedUserMailboxSmtpAddress,a.label=1;case 1:return a.trys.push([1,3,,4]),[4,(c=t,s={type:"SharedMailbox",userIdentity:Object(y.b)(),mailboxSmtpAddress:c},u=Object(z.a)(s),V({Header:Object(q.b)(),Body:{}},u))];case 2:return r=a.sent(),"Success"===(null===(o=null==r?void 0:r.Body)||void 0===o?void 0:o.ResponseClass)?G(t,r.Body.RetentionPolicyTags):m.d("Initialize shared folders policy tags server call failed with error "+(null===(i=null==r?void 0:r.Body)||void 0===i?void 0:i.MessageText)),[3,4];case 3:return n=a.sent(),m.d("Initialize shared folders policy tags server call failed with error "+n),[3,4];case 4:return[2]}var c,s,u}))}))}));var W=r(31),$=Object(W.e)(R.B,"initializeSharedFolderRootsOrchestratorClone",(function(e){return Object(d.c)(void 0,void 0,void 0,(function(){var e,t;return Object(d.f)(this,(function(r){switch(r.label){case 0:return[4,J()];case 1:return e=r.sent(),(t=null==e?void 0:e.OtherMailboxEntries)?t.length>0&&(t.forEach((function(e){F(e.DisplayName,e.PrincipalSMTPAddress,!0)})),n=t.length,Object(p.s)("Triage_SharedFolders_LoadList",[Object(T.e)({value:n})])):m.d("initializeSharedFolderRoots failed with getOtherMailboxConfiguration response as : "+e),[2]}var n}))}))}));r.d(t,"SharedFolderPeoplePicker",(function(){return I})),r.d(t,"showSharedFolderPeoplePickerDialog",(function(){return E})),r.d(t,"removeSharedFolderUser",(function(){return A})),r.d(t,"initializeSharedFolderRootsOrchestrator",(function(){return $}))},731:function(e,t,r){"use strict";r.d(t,"b",(function(){return c}));var n=r(31),o=r(863);r.d(t,"a",(function(){return o.a}));var i=new n.c((function(){return Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(5),r.e(32),r.e(215),r.e(596)]).then(r.bind(null,1555))})),a=new n.b(i,(function(e){return e.confirmAction}));function c(e,t,r,n){return a.import().then((function(o){return o(e,t,r,n)}))}},7413:function(e,t,r){"use strict";r.d(t,"b",(function(){return i}));var n=r(2),o={showPeoplePickerDialog:!1,retentionPolicyTags:new(r(14).ObservableMap)({})},i=Object(n.createStore)("sharedFolderState",o),a=i();t.a=a},7419:function(e){e.exports=JSON.parse('{"a":"TDa"}')},8180:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(2),o=r(57),i=Object(n.action)("GET_SHARED_FOLDERS",(function(e,t,r,n){return n||(n=Object(o.b)()),{sharedUserMailboxSmtpAddress:e,actionSource:t,isLoadingMore:r,userIdentity:n}}))},8238:function(e,t,r){"use strict";r.d(t,"b",(function(){return o})),r.d(t,"a",(function(){return i}));var n=r(2),o=Object(n.action)("populateUserMailboxInfo",(function(e){return{userMailboxWrapper:e}})),i=Object(n.action)("ON_DISMISSED")},8239:function(e,t,r){"use strict";r.d(t,"b",(function(){return a}));var n=r(2007),o=r(2),i={userMailboxWrapper:null,findControlViewState:{queryString:"",findResultSet:[],findResultType:n.b.None,isSearching:!1,directorySearchType:n.a.None,findPeopleFeedbackManager:null,numberOfCacheResults:0}},a=Object(o.createStore)("peoplePickerDialogStore",i);t.a=a()},863:function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e[e.ok=0]="ok",e[e.cancel=1]="cancel",e[e.dismiss=2]="dismiss",e[e.continue=3]="continue"}(n||(n={}))}}]);
//# sourceMappingURL=owa.MailBoot~SharedFolders.js.map
self.scriptsLoaded['owa.MailBoot~SharedFolders.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~SharedFolders.js'] = (new Date()).getTime();