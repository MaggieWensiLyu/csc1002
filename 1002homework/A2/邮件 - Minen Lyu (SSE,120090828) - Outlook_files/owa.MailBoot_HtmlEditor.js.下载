self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailBoot~HtmlEditor.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[669],{131:function(e,t,n){"use strict";var a=n(294),i=n(24);function r(){return Object(i.i)("fwk-suiteThemes")}var o=n(213);function c(){var e,t;return r()?null!==(t=null===(e=Object(o.d)())||void 0===e?void 0:e.Id)&&void 0!==t?t:"base":Object(a.a)()}function l(e,t){var n,i;if(r())return null!==(i=t?null===(n=Object(o.d)())||void 0===n?void 0:n.DarkTheme:Object(o.d)())&&void 0!==i?i:{};var c=Object(a.e)(e,t);return{BackgroundImageUrl:c.primary,BackgroundImageRepeat:c.repeat}}var u=n(47);function s(){if(r()){var e=Object(o.c)();if(Object(u.e)()){var t={};return Object.keys(e).forEach((function(e){t[e]="var(--"+e+")"})),t}return e}return Object(a.f)()}function f(e,t){return r()?Object(o.c)():Object(a.g)(e,t)}var d=n(132),m=n(45);function h(){var e=c(),t=Object(d.e)();return!t&&(e===m.a.BASE_OFFICE_THEME_ID||e==m.a.BASE_THEME_ID&&!Object(u.i)(e,t))}function v(){var e=c(),t=Object(d.e)();return t&&(e===m.a.BASE_OFFICE_THEME_ID||e==m.a.BASE_THEME_ID&&!Object(u.i)(e,t))}n.d(t,"d",(function(){return c})),n.d(t,"a",(function(){return"#0078D4"})),n.d(t,"e",(function(){return l})),n.d(t,"h",(function(){return s})),n.d(t,"i",(function(){return f})),n.d(t,"g",(function(){return h})),n.d(t,"f",(function(){return v})),n.d(t,"b",(function(){return u.c})),n.d(t,"j",(function(){return u.e})),n.d(t,"l",(function(){return u.g})),n.d(t,"k",(function(){return u.f})),n.d(t,"c",(function(){return u.d}))},2169:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var a=n(1),i=n(31),r=n(2435);function o(e,t,n,o,c){return function(){function l(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.onImportedCallbacks=[],this.args=e,this.pluginName=n}return l.prototype.initialize=function(e){this.editor=e,this.pendingEvents=[],this.pluginInstance?this.initializeAndCallback():o||this.internalImport()},l.prototype.dispose=function(){this.pluginInstance&&(this.pluginInstance.dispose(),c||(this.pluginInstance=null)),this.editor=null,this.importPluginPromise=null,this.onImportedCallbacks=[]},l.prototype.getName=function(){return this.isImported()?this.pluginInstance.getName():this.pluginName},l.prototype.setPluginUtils=function(e){this.pluginUtils=e,Object(r.a)(this.pluginInstance)&&this.pluginInstance.setPluginUtils(this.pluginUtils)},l.prototype.getContextMenuItems=function(e){var t,n;return this.isImported()?null===(n=(t=this.pluginInstance).getContextMenuItems)||void 0===n?void 0:n.call(t,e):null},l.prototype.onPluginEvent=function(e){this.pluginInstance?this.pluginInstance.onPluginEvent&&this.pluginInstance.onPluginEvent(e):(null==o?void 0:o(e,this.editor))&&this.internalImport(e)},l.prototype.willHandleEventExclusively=function(e){return!(!this.pluginInstance||!this.pluginInstance.willHandleEventExclusively)&&this.pluginInstance.willHandleEventExclusively(e)},l.prototype.getPlugin=function(){return this.pluginInstance?Promise.resolve(this.pluginInstance):this.internalImport()},l.prototype.isImported=function(){return!!this.pluginInstance},l.prototype.addOnImportedCallback=function(e){this.isImported()&&this.editor?e(this.pluginInstance):this.onImportedCallbacks&&this.onImportedCallbacks.push(e)},l.prototype.initializeAndCallback=function(){var e=this;this.pluginInstance.initialize(this.editor),this.onImportedCallbacks.forEach((function(t){return t(e.pluginInstance)}))},l.prototype.internalImport=function(n){var r=this;return this.importPluginPromise||(this.importPluginPromise=new i.b(e,t).import().then((function(e){return r.pluginInstance=new(e.bind.apply(e,Object(a.j)([void 0],Object(a.g)(r.args)))),r.setPluginUtils(r.pluginUtils),r.editor&&(r.initializeAndCallback(),r.pendingEvents.length>0&&r.pluginInstance.onPluginEvent&&r.pendingEvents.forEach((function(e){r.pluginInstance.onPluginEvent(e)})),r.pendingEvents=[]),r.pluginInstance})),this.importPluginPromise.catch((function(){r.pendingEvents=[]}))),n&&this.pendingEvents.push(n),this.importPluginPromise},l}()}},227:function(e,t,n){"use strict";n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}));var a=n(8),i=n(42);function r(){var e,t=Object(i.a)("DefaultAnchorMailbox");return null==t||0==t.trim().length||(e=Object(a.b)(window.location),Object.keys(e).indexOf("anonRetry")>=0)}function o(){var e=Object(a.b)(window.location);return Object.keys(e).indexOf("anonymous")>=0}},2340:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var a=n(1),i=n(2463),r=n(2634),o=n(121),c="EditorRibbonUsage";function l(e,t){for(var n,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];return Object(i.b)(e,(function(e){var i;n=(i=e[t]).call.apply(i,Object(a.j)([e],Object(a.g)(r)))}),null),n}function u(e,t,n,l){var u;void 0===n&&(n=[]),void 0===l&&(l=n);var s=r[t];return Object(i.b)(e,(function(e){u=s.apply(void 0,Object(a.j)([e],Object(a.g)(n))),(null==l?void 0:l.length)>0&&Object(o.s)(c+t,Object(a.j)(Object(a.j)([],Object(a.g)(l.map((function(e){return JSON.stringify(e)})))),[e.isDarkMode()]))}),null),u}},2435:function(e,t,n){"use strict";function a(e){return e&&!!e.setPluginUtils}n.d(t,"a",(function(){return a}))},2463:function(e,t,n){"use strict";n.d(t,"a",(function(){return r})),n.d(t,"c",(function(){return o})),n.d(t,"b",(function(){return c}));var a=n(121),i={};function r(e,t,n){var r,o=null===(r=i[e.editorId])||void 0===r?void 0:r.htmlEditor;if(t&&o){var c=o.getDocument().defaultView,l=t.getDocument().defaultView,u=c==l,s=window==c,f=window==l;Object(a.s)("DebugEditor108089",{eventName:"DuplicatedEditor",inSameWindow:u,OriginalInProjection:s,NewInProjection:f,editorId:e.editorId})}i[e.editorId]={htmlEditor:t,plainTextEditor:n}}function o(e,t,n){var r=i[e.editorId],o=!1;r&&(r.htmlEditor==t&&(r.htmlEditor=null,o=!0),r.plainTextEditor==n&&(r.plainTextEditor=null,o=!0),r.htmlEditor||r.plainTextEditor||delete i[e.editorId]),!o&&t&&Object(a.s)("DebugEditor108089",{eventName:"NoEditorToRemove",hasOperator:!!r,hasOriginalEditor:!!(null==r?void 0:r.htmlEditor),removingEditorId:e.editorId})}function c(e,t,n,a){if(e){var r=e.bodyType,o=void 0===r||"HTML"===r,c="Text"===r,l=i[e.editorId]||{},u=l.htmlEditor,s=l.plainTextEditor;o&&t&&(u&&!u.isDisposed()||a)?t(u):c&&n&&(s||a)&&n(s)}}},287:function(e,t,n){"use strict";var a=n(295),i=n(18);function r(e){return Object(a.resolve)(Object(i.g)(),e)}function o(e){return r("resources/images/"+e)}n.d(t,"b",(function(){return r})),n.d(t,"a",(function(){return o}))},2984:function(e,t,n){"use strict";var a=n(2),i=n(3484),r=n(121);t.a=function(e,t,n){if(e.content!=t&&(o(e,t),n||Object(i.a)(e,!0),(null==t?void 0:t.indexOf("data-ogsc="))>0)){var a=new Error,l=e.isDarkMode,u=c(e)?e.bodyType:"",s=c(e)?e.preferredEditors[u]:"";Object(r.s)("DebugEditor108089",{eventName:"NoColorTransform",editorId:e.editorId,callstack:a.stack,length:t.length,isInitializing:n,isDarkMode:l,bodyType:u,activeEditor:s})}};var o=Object(a.mutatorAction)("Editor_UpdateContent",(function(e,t){e.content=t}));function c(e){return!!e.preferredEditors}},3002:function(e,t,n){"use strict";n.r(t);var ReactEditor=n(8504),a=n(2001),i="TD",r="TH";function o(e,t,n){e.contains(t)&&e.addUndoSnapshot((function(){var e=new a.VTable(t);e.row=0,e.forEachCellOfCurrentRow((function(e,t){e.td&&Object(a.changeElementTag)(e.td,n?i:r)}))}))}var c=n(2463),l=n(7399),u=n(8176);var s=n(9507),f=n(2984),d=n(8175),m=n(2634);function h(e,t,n){var i;Object(c.b)(e,t&&function(n){if(n){e.selectionPath&&(n.select(e.selectionPath),Object(d.a)(e,null));var r=t(n,n.getSelectionRange(),a,m);n.select(r),i=n.getContent()}else{var o=function(e){var t=document.createElement("div");return new l.Editor(t,{initialContent:e.content,undoSnapshotService:Object(u.a)(e)})}(e);o.select(e.selectionPath);r=t(o,o.getSelectionRange(),a,m);o.select(r),i=o.getContent(),Object(d.a)(e,o.getSelectionPath()),o.dispose()}},n&&function(t){var a;if(t){if(a=n(t.value,t.selectionStart,t.selectionEnd)){var r=a.value,o=a.selectionStart,c=a.selectionEnd,l=a.focus;if(i=t.value=r,l){t.focus();var u=o||0,f=c||0;t.selectionStart=u,t.selectionEnd=f,Object(s.a)(e,u,f)}}}else if(a=n(e.content,e.selectionStart||0,e.selectionEnd||0)){r=a.value,o=a.selectionStart,c=a.selectionEnd;i=r,Object(s.a)(e,o||0,c||0)}},!0),null!=i&&Object(f.a)(e,i)}function v(e){h(e,(function(e,t){return t||(e.focus(),t=e.getSelectionRange()),t}),(function(e,t,n){return{value:e,selectionStart:t,selectionEnd:n,focus:!0}}))}n.d(t,"ReactEditor",(function(){return ReactEditor.a})),n.d(t,"setTableHeaderRow",(function(){return o})),n.d(t,"operateContent",(function(){return h})),n.d(t,"focusToEditor",(function(){return v}))},3484:function(e,t,n){"use strict";var a=n(183);t.a=Object(a.action)("setIsDirty")((function(e,t){e.isDirty=t}))},378:function(e,t,n){var a;
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var a=arguments[t];if(a){var r=typeof a;if("string"===r||"number"===r)e.push(this&&this[a]||a);else if(Array.isArray(a))e.push(i.apply(this,a));else if("object"===r)for(var o in a)n.call(a,o)&&a[o]&&e.push(this&&this[o]||o)}}return e.join(" ")}e.exports?(i.default=i,e.exports=i):void 0===(a=function(){return i}.apply(t,[]))||(e.exports=a)}()},4084:function(e,t,n){"use strict";var a=n(2),i=Object(a.mutatorAction)("SetShouldUpdateContentOnDispose",(function(e,t){e.shouldUpdateContentOnDispose=t}));t.a=i},4351:function(e,t,n){"use strict";function a(e){return e.localizedName?e.localizedName:e.name}var i=[{name:"Arial",family:"Arial,Helvetica,sans-serif"},{name:"Arial Black",family:"'Arial Black',Arial,sans-serif"},{name:"Calibri",family:"Calibri,Helvetica,sans-serif"},{name:"Calibri Light",family:"'Calibri Light','Helvetica Light',sans-serif"},{name:"Cambria",family:"Cambria,Georgia,serif"},{name:"Candara",family:"Candara,Optima,sans-serif"},{name:"Century Gothic",family:"'Century Gothic',sans-serif"},{name:"Comic Sans MS",family:"'Comic Sans MS',Chalkboard,cursive"},{name:"Consolas",family:"Consolas,Courier,monospace"},{name:"Constantia",family:"Constantia,'Hoefler Text',serif"},{name:"Corbel",family:"Corbel,Skia,sans-serif"},{name:"Courier New",family:"'Courier New',monospace"},{name:"Franklin Gothic Book",family:"'Franklin Gothic Book','Avenir Next Condensed',sans-serif"},{name:"Franklin Gothic Demi",family:"'Franklin Gothic Demi','Avenir Next Condensed Demi Bold',sans-serif"},{name:"Franklin Gothic Medium",family:"'Franklin Gothic Medium','Avenir Next Condensed Medium',sans-serif"},{name:"Garamond",family:"Garamond,Georgia,serif"},{name:"Georgia",family:"Georgia,serif"},{name:"Impact",family:"Impact,Charcoal,sans-serif"},{name:"Lucida Console",family:"'Lucida Console',Monaco,monospace"},{name:"Lucida Handwriting",family:"'Lucida Handwriting','Apple Chancery',cursive"},{name:"Lucida Sans Unicode",family:"'Lucida Sans Unicode','Lucida Grande',sans-serif"},{name:"Palatino Linotype",family:"'Palatino Linotype','Book Antiqua',Palatino,serif"},{name:"Segoe UI",family:"'Segoe UI','Helvetica Neue',sans-serif"},{name:"Sitka Heading",family:"'Sitka Heading',Cochin,serif"},{name:"Sitka Text",family:"'Sitka Text',Cochin,serif"},{name:"Tahoma",family:"Tahoma,Geneva,sans-serif"},{name:"Times",family:"Times,'Times New Roman',serif"},{name:"Times New Roman",family:"'Times New Roman',Times,serif"},{name:"Trebuchet MS",family:"'Trebuchet MS',Trebuchet,sans-serif"},{name:"TW Cen MT",family:"'TW Cen MT','Century Gothic',sans-serif"},{name:"Verdana",family:"Verdana,Geneva,sans-serif"},{name:"-",family:"-"},{name:"Microsoft YaHei",family:"'Microsoft YaHei','微软雅黑',STHeiti,sans-serif",localizedName:"微软雅黑"},{name:"SimHei",family:"SimHei,'黑体',STHeiti,sans-serif",localizedName:"黑体"},{name:"NSimSun",family:"NSimSun,'新宋体',SimSun,'宋体',SimSun-ExtB,'宋体-ExtB',STSong,serif",localizedName:"新宋体"},{name:"FangSong",family:"FangSong,'仿宋',STFangsong,serif",localizedName:"仿宋"},{name:"SimLi",family:"SimLi,'隶书','Baoli SC',serif",localizedName:"隶书"},{name:"KaiTi",family:"KaiTi,'楷体',STKaiti,serif",localizedName:"楷体"},{name:"-",family:"-"},{name:"Microsoft JhengHei",family:"'Microsoft JhengHei','微軟正黑體','Apple LiGothic',sans-serif",localizedName:"微軟正黑體"},{name:"PMingLiU",family:"PMingLiU,'新細明體',PMingLiU-ExtB,'新細明體-ExtB','Apple LiSung',serif",localizedName:"新細明體"},{name:"DFKai-SB",family:"DFKai-SB,'標楷體','BiauKai',serif",localizedName:"標楷體"},{name:"-",family:"-"},{name:"Meiryo",family:"Meiryo,'メイリオ','Hiragino Sans',sans-serif",localizedName:"メイリオ"},{name:"MS PGothic",family:"'MS PGothic','ＭＳ Ｐゴシック','MS Gothic','ＭＳ ゴシック','Hiragino Kaku Gothic ProN',sans-serif",localizedName:"ＭＳ Ｐゴシック"},{name:"MS PMincho",family:"'MS PMincho','ＭＳ Ｐ明朝','MS Mincho','ＭＳ 明朝','Hiragino Mincho ProN',serif",localizedName:"ＭＳ Ｐ明朝"},{name:"Yu Gothic",family:"'Yu Gothic','游ゴシック','YuGothic',sans-serif",localizedName:"游ゴシック"},{name:"Yu Mincho",family:"'Yu Mincho','游明朝','YuMincho',serif",localizedName:"游明朝"},{name:"-",family:"-"},{name:"Malgun Gothic",family:"'Malgun Gothic','맑은 고딕',AppleGothic,sans-serif",localizedName:"맑은 고딕"},{name:"Gulim",family:"Gulim,'굴림','Nanum Gothic',sans-serif",localizedName:"굴림"},{name:"Dotum",family:"Dotum,'돋움',AppleGothic,sans-serif",localizedName:"돋움"},{name:"Batang",family:"Batang,'바탕',AppleMyungjo,serif",localizedName:"바탕"},{name:"BatangChe",family:"BatangChe,'바탕체',AppleMyungjo,serif",localizedName:"바탕체"},{name:"Gungsuh",family:"Gungsuh,'궁서',GungSeo,serif",localizedName:"궁서"},{name:"-",family:"-"},{name:"Leelawadee UI",family:"'Leelawadee UI',Thonburi,sans-serif"},{name:"Angsana New",family:"'Angsana New','Leelawadee UI',Sathu,serif"},{name:"Cordia New",family:"'Cordia New','Leelawadee UI',Silom,sans-serif"},{name:"DaunPenh",family:"DaunPenh,'Leelawadee UI','Khmer MN',sans-serif"},{name:"-",family:"-"},{name:"Nirmala UI",family:"'Nirmala UI',sans-serif"},{name:"Gautami",family:"Gautami,'Nirmala UI','Telugu MN',sans-serif"},{name:"Iskoola Pota",family:"'Iskoola Pota','Nirmala UI','Sinhala MN',sans-serif"},{name:"Kalinga",family:"Kalinga,'Nirmala UI','Oriya MN',sans-serif"},{name:"Kartika",family:"Kartika,'Nirmala UI','Malayalam MN',sans-serif"},{name:"Latha",family:"Latha,'Nirmala UI','Tamil MN',sans-serif"},{name:"Mangal",family:"Mangal,'Nirmala UI','Devanagari Sangam MN',sans-serif"},{name:"Raavi",family:"Raavi,'Nirmala UI','Gurmukhi MN',sans-serif"},{name:"Shruti",family:"Shruti,'Nirmala UI','Gujarati Sangam MN',sans-serif"},{name:"Tunga",family:"Tunga,'Nirmala UI','Kannada MN',sans-serif"},{name:"Vrinda",family:"Vrinda,'Nirmala UI','Bangla MN',sans-serif"},{name:"-",family:"-"},{name:"Nyala",family:"Nyala,Kefa,sans-serif"},{name:"Sylfaen",family:"Sylfaen,Mshtakan,Menlo,serif"}];function r(e){for(var t=e.toUpperCase(),n=0;n<i.length;n++){var a=i[n];if(a.name.toUpperCase()==t||a.localizedName&&a.localizedName.toUpperCase()==t)return a.family}return null}var o="pt",c=[8,10,12,14,18,24,36],l=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72],u=l.map((function(e){return e.toString()}));function s(e){return"number"==typeof e&&e<=7?c[e-1]:e}function f(e){var t=s(e).toString();return t?t+o:t}var d=n(5188),m=n(6),h=[{option:"uppercase",name:Object(m.b)(d.d)},{option:"lowercase",name:Object(m.b)(d.b)},{option:"capitalize",name:Object(m.b)(d.a)},{option:"sentence",name:Object(m.b)(d.c)}];n.d(t,"h",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"e",(function(){return r})),n.d(t,"c",(function(){return l})),n.d(t,"d",(function(){return u})),n.d(t,"f",(function(){return s})),n.d(t,"g",(function(){return f})),n.d(t,"a",(function(){return h}))},4714:function(e,t,n){"use strict";n.d(t,"d",(function(){return a})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return r})),n.d(t,"a",(function(){return o}));var a=["#51a7f9","#6fc040","#f5d427","#f3901d","#ed5c57","#b36ae2","#0c64c0","#0c882a","#dcbe22","#de6a19","#c82613","#763e9b","#174e86","#0f5c1a","#c3971d","#be5b17","#861106","#5e327c","#002451","#06400c","#a37519","#934511","#570606","#3b204d","#ffffff","#cccccc","#999999","#666666","#333333","#000000"],i=["#0075c2","#207a00","#5d4d00","#ab5500","#df504d","#ab63da","#6da0ff","#3da848","#6d5c00","#d3610c","#ff6847","#d394f9","#93b8f9","#7fc57b","#946f00","#de7633","#ff9b7c","#dea9fd","#cedbff","#a3da9b","#b5852a","#ef935c","#ffc0b1","#eecaff","#333333","#535353","#777777","#a0a0a0","#cfcfcf","#ffffff"],r=["#00ffff","#00ff00","#ffff00","#ff8000","#ff0000","#ff00ff","#80ffff","#80ff80","#ffff80","#ffc080","#ff8080","#ff80ff","#ffffff","#cccccc","#999999","#666666","#333333","#000000"],o=["#005357","#005e00","#383e00","#bf4c00","#ff2711","#e700e8","#004c4f","#005400","#343c00","#77480b","#bc454a","#aa2bad","#333333","#535353","#777777","#a0a0a0","#cfcfcf","#ffffff"]},4980:function(e,t,n){"use strict";var a=n(1),i=n(19),r=n(4351),o=n(4714);n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var c={fontFamily:"Calibri,Arial,Helvetica,sans-serif",fontSize:"11pt",textColor:"#000000",bold:!1,italic:!1,underline:!1};function l(e){var t=Object(i.a)().UserOptions;return t?u(t.ComposeFontName,t.ComposeFontSize,t.ComposeFontColor,t.ComposeFontFlags,!!e):c}function u(e,t,n,i,l){var u=Object(a.a)({},c),s=e?Object(r.e)(e):null;s&&(u.fontFamily=s);var f,d=t?Object(r.g)(t):null;if(d&&(u.fontSize=d),n){if(l){var m=(f=n,o.b[o.d.indexOf(f)]);m?u.textColors={lightModeColor:n,darkModeColor:m}:u.textColor=n}u.textColor=n}return i&&(u.bold=1==(1&i),u.italic=2==(2&i),u.underline=4==(4&i)),u}},5188:function(e){e.exports=JSON.parse('{"d":"wfa","b":"xfa","a":"yfa","c":"zfa"}')},5562:function(e,t,n){"use strict";var a=n(7142),i=n.n(a),r=n(2);t.a=Object(r.mutatorAction)("Editor_Initialize_Undo_Snapshot",(function(e){e.undoSnapshot=i()(1e7)}))},5636:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(2340);function i(e,t){var n=e.selectedImage;if(!n&&t){var i=Object(a.a)(e,"queryElements","img",1);n=null==i?void 0:i[0]}return n}},707:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var a=n(33);function i(e){return Object(a.a)("GetOwaNonBootUserConfiguration",{},e)}},711:function(e,t,n){"use strict";var a,i=n(707),r=n(2),o=Object(r.createStore)("nonBootUserConfiguration",{nonBootUserConfiguration:null})(),c=n(227),l=Object(r.mutatorAction)("setNonBootUserConfiguration",(function(e){o.nonBootUserConfiguration=e}));function u(){return Object(c.b)()?Promise.resolve({}):o.nonBootUserConfiguration?Promise.resolve(o.nonBootUserConfiguration):(a||(a=Object(i.a)().then((function(e){return l(e),e})).catch((function(e){throw a=void 0,e}))),a)}var s=u;function f(){return o.nonBootUserConfiguration||u(),o.nonBootUserConfiguration}function d(){var e=(f()||{}).IsEdu;return void 0!==e&&e}function m(){var e=(f()||{}).ExternalInOutlookEnabled;return void 0!==e&&e}n.d(t,"b",(function(){return s})),n.d(t,"c",(function(){return f})),n.d(t,"d",(function(){return d})),n.d(t,"a",(function(){return m}))},8174:function(e,t,n){var a=n(9477),i=n(78);"string"==typeof a&&(a=[[e.i,a]]);for(var r=0;r<a.length;r++)i.loadStyles(a[r][1],!1);a.locals&&(e.exports=a.locals)},8175:function(e,t,n){"use strict";var a=n(2),i=Object(a.mutatorAction)("SetCachedSelection",(function(e,t){e.selectionPath=t}));t.a=i},8176:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var a=n(2),i=n(2001),r=n(5562),o=Object(a.mutatorAction)("Undo_Move",(function(e,t){Object(i.moveCurrentSnapsnot)(e,t)})),c=Object(a.mutatorAction)("Undo_AddSnapshot",(function(e,t,n){return Object(i.addSnapshot)(e,t,n)})),l=Object(a.mutatorAction)("Undo_ClearRedo",(function(e){return Object(i.clearProceedingSnapshots)(e)}));function u(e){e.undoSnapshot||Object(r.a)(e);var t=e.undoSnapshot;return{canMove:function(e){return Object(i.canMoveCurrentSnapshot)(t,e)},move:function(e){return o(t,e),t.snapshots[t.currentIndex]},addSnapshot:function(e,n){return c(t,e,n)},clearRedo:function(){return l(t)},canUndoAutoComplete:function(){return Object(i.canUndoAutoComplete)(t)}}}},8504:function(e,t,n){"use strict";var a=n(1),i=n(9478),r=n(6),o=n(20),c=n(4980),l=n(2463),u=n(2001),s=n(2634);function f(e){return function(t,n){if("undefined"!=typeof MutationObserver){var a=new MutationObserver(t);return a.observe(e,n),function(){a.disconnect()}}return function(){}}}function d(e){return function(t,n){var a=e.parentElement;a&&t.observe(a,n)}}function m(e){return function(t,n){return t.spellCheck(e,n)}}var h=n(2435),v=n(3295),p=n(24),g=n(3484),b=n(8175),y=n(4084),S=n(2),k=Object(S.mutatorAction)("Editor_setAdditionalProps",(function(e,t,n){e.textDirection=t,e.keyStrokeCount=n})),C=n(2984),O=function(){function e(e,t,n){this.viewState=e,this.updateOnKeyPress=t,this.updateOnDispose=n}return e.prototype.getName=function(){return"ViewStateManage"},e.prototype.initialize=function(e){this.editor=e,this.keyStrokeCount=this.viewState.keyStrokeCount,Object(y.a)(this.viewState,this.updateOnDispose)},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){3==e.eventType?(this.updateOnKeyPress?this.updateContentToViewState():this.viewState.isDirty||Object(g.a)(this.viewState,!0),this.keyStrokeCount++,this.clearCachedSelection()):7==e.eventType?this.clearCachedSelection():12==e.eventType&&this.viewState.shouldUpdateContentOnDispose?(this.updateContentToViewState(),this.editor.getSelectionRange()&&Object(b.a)(this.viewState,this.editor.getSelectionPath())):8==e.eventType&&k(this.viewState,this.getTextDirection(),this.keyStrokeCount)},e.prototype.updateContentToViewState=function(){this.editor&&Object(C.a)(this.viewState,this.editor.getContent())},e.prototype.getTextDirection=function(){var e,t,n=null===(t=null===(e=this.editor)||void 0===e?void 0:e.getEditorDomAttribute("dir"))||void 0===t?void 0:t.toLowerCase();return"ltr"==n||"rtl"==n?n:null},e.prototype.clearCachedSelection=function(){this.viewState.selectionPath&&Object(b.a)(this.viewState,null)},e}(),j=Object(S.mutatorAction)("Editor_SelectImage",(function(e,t){e.selectedImage=t})),I=n(5636),w=function(){function e(e){this.viewState=e}return e.prototype.getName=function(){return"SelectImage"},e.prototype.initialize=function(e){var t=this;this.editor=e,j(this.viewState,null),this.editor.getDocument().execCommand("enableObjectResizing",!1,"false"),this.editor.addContentEditFeature({keys:[46,8],shouldHandleEvent:function(){return!!Object(I.a)(t.viewState)},handleEvent:function(e){e.rawEvent.stopPropagation(),e.rawEvent.preventDefault(),t.editor.addUndoSnapshot((function(){t.editor.deleteNode(Object(I.a)(t.viewState)),t.selectImage(null)}),"DeleteImage")}})},e.prototype.dispose=function(){this.editor=null},e.prototype.onPluginEvent=function(e){if(6===e.eventType&&0==e.rawEvent.button){var t=e.rawEvent.target;this.selectImage("IMG"==(null==t?void 0:t.nodeName)?t:null)}else 0===e.eventType&&this.selectImage(null)},e.prototype.selectImage=function(e){var t;j(this.viewState,null),"a"!==(null===(t=null==e?void 0:e.parentElement)||void 0===t?void 0:t.tagName.toLowerCase())&&(j(this.viewState,e),this.editor.focus(),this.editor.select(e,-3))},e}(),E=n(8176),T=n(102),N=n(0),M=n(7399);function B(e){var t=[];function n(e){(function(e){return e&&!!e.getUIComponentClass})(e)&&(r&&r.indexOf(e)<0?o(Object(a.j)(Object(a.j)([],Object(a.g)(r)),[e])):t&&t.indexOf(e)<0&&t.push(e))}(e.plugins||[]).forEach((function(e){!function(e){return e&&!!e.addOnImportedCallback}(e)?n(e):e.addOnImportedCallback(n)}));var i=Object(a.g)(N.useState(t),2),r=i[0],o=i[1];return t=null,N.createElement(N.Fragment,null,r.map((function(e){return N.createElement(e.getUIComponentClass(),{viewState:e.adapter(),editorViewState:e.editorAdapter(),plugin:e,key:e.getName()})})))}var x=n(19),P=n(2169),U=new(n(31).c)((function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(24),n.e(47),n.e(268),n.e(671)]).then(n.bind(null,18492))})),A=Object(P.a)(U,(function(e){return e.ContentEdit}),"ContentEdit",K),D=Object(P.a)(U,(function(e){return e.HyperLink}),"HyperLink",K),L=Object(P.a)(U,(function(e){return e.Paste}),"Paste",K),z=Object(P.a)(U,(function(e){return e.TableResize}),"TableResize",K),G=Object(P.a)(U,(function(e){return e.OwaWatermark}),"Watermark",K),H=Object(P.a)(U,(function(e){return e.ImageResize}),"ImageResize",K),F=Object(P.a)(U,(function(e){return e.OwaContextMenu}),"ContextMenu",K),R=Object(P.a)(U,(function(e){return e.OwaCustomReplace}),"CustomReplace",K),_=Object(P.a)(U,(function(e){return e.CutPasteListChain}),"CutPasteListChain",K);function K(e){return 11==e.eventType}var V={getName:function(){return"CtsWorkaround"},initialize:function(){},dispose:function(){},onPluginEvent:function(e){10==e.eventType&&Object(u.chainSanitizerCallback)(e.sanitizingOption.cssStyleCallbacks,Y,(function(e,t,n){return n[Y]=e,"pre"!=e}))}},Y="white-space",W=V;var J,X,Q=n(131),Z=n(121),q="OWAPerfLogCustomData",$="roosterjsMarker_",ee="roosterjsMeasure_",te="RoosterJsPerfMeasure",ne=((J={})[0]={timeThreshold:150,measureGroupSize:10,repeatTestCount:4,minViolationCount:5,handler:function(e,t,n,a){0==n.eventType&&ce(a,t),e.plugins.forEach((function(e){var t;return null===(t=e.onPluginEvent)||void 0===t?void 0:t.call(e,n)})),2==n.eventType&&le(a,t)}},J[1]={timeThreshold:100,measureGroupSize:40,repeatTestCount:2,minViolationCount:2,handler:function(e,t,n,a){ce(a,t,n.eventType),e.plugins.forEach((function(e){var t;return null===(t=e.onPluginEvent)||void 0===t?void 0:t.call(e,n)})),le(a,t)}},J[2]={timeThreshold:50,measureGroupSize:200,repeatTestCount:1,minViolationCount:1,handler:function(e,t,n,a){e.plugins.forEach((function(e){e.onPluginEvent&&(ce(a,t,n.eventType,e.getName()),e.onPluginEvent(n),le(a,t))}))}},J[3]={timeThreshold:Number.MAX_VALUE,measureGroupSize:Number.MAX_VALUE,repeatTestCount:Number.MAX_VALUE,minViolationCount:Number.MAX_VALUE,handler:function(e,t,n){e.plugins.forEach((function(e){var t;return null===(t=e.onPluginEvent)||void 0===t?void 0:t.call(e,n)}))}},J),ae=((X={})[0]="keydown",X[1]="keypress",X[3]="input",X[2]="keyup",X);function ie(e){return function(t,n,a){if(!t.lifecycle.shadowEditFragment&&(a||!t.plugins.some((function(e){return function(e,t){var n;if(t.onPluginEvent&&(null===(n=t.willHandleEventExclusively)||void 0===n?void 0:n.call(t,e)))return t.onPluginEvent(e),!0;return!1}(n,e)})))){var i=n.eventType,r=0==i||1==i||3==i||2==i,o=function(e,t){return(e.lifecycle.customData[q]=e.lifecycle.customData[q]||{value:{stage:0,markerIndexes:[],meetThresholdCount:0},disposer:function(e){ue(e,t)}}).value}(t,e);(0,ne[r?o.stage:3].handler)(t,e,n,o)}}}function re(e,t){return $+e+"_"+t}function oe(e){return ee+e}function ce(e,t,n,a){var i=e.markerIndexes,r=i[i.length-1],o=2*i.length;(null==r?void 0:r.endIndex)<0&&(r.endIndex=o),i.push({startIndex:o,endIndex:-1,eventType:n,pluginName:a}),window.performance.mark(re(t,o))}function le(e,t){var n=e.markerIndexes,a=n[n.length-1],i=2*n.length-1;(null==a?void 0:a.endIndex)<0&&(window.performance.mark(re(t,i)),a.endIndex=i);var r=ne[e.stage],o=r.measureGroupSize,c=r.timeThreshold,l=r.minViolationCount,u=r.repeatTestCount;if(n.length>=o){var s=oe(t);n.forEach((function(e){window.performance.measure(s,re(t,e.startIndex),re(t,e.endIndex))}));var f=window.performance.getEntriesByName(s),d=f.filter((function(e){return e.duration>c}));d.length<l?0==e.stage||(e.meetThresholdCount>0?e.meetThresholdCount--:(e.stage=2==e.stage?1:0,e.meetThresholdCount=ne[e.stage].repeatTestCount-1)):e.meetThresholdCount+1<u?e.meetThresholdCount++:2==e.stage?(d.forEach((function(e){var a=f.indexOf(e),i=n[a];!function(e,t,n,a){Object(Z.s)(te,{editorId:e,event:ae[t],plugin:n,duration:a})}(t,i.eventType,i.pluginName,e.duration)})),e.stage=3):(e.stage=0==e.stage?1:2,e.meetThresholdCount=0),ue(e,t)}}function ue(e,t){window.performance.clearMeasures(oe(t)),e.markerIndexes.forEach((function(e){window.performance.clearMarks(re(t,e.startIndex)),window.performance.clearMarks(re(t,e.endIndex))})),e.markerIndexes=[]}var se=n(8174),fe=n(378).bind(se),de=Object(o.a)((function(e,t){var n=e.onFocus,o=e.classNames,g=e.viewState,b=e.watermark,y=e.ariaLabel,S=e.isDarkMode,k=e.plugins,j=e.focusOnInit,I=e.watermarkFormat,P=e.scrollContainerSelector,U=e.onBlur,K=e.updateOnKeyPress,V=e.updateOnDispose,Y=e.measurePerf,J=N.useRef(),X=N.useRef(),Z=N.useRef(S);N.useImperativeHandle(t,(function(){return{focus:function(){var e;null===(e=J.current)||void 0===e||e.focus()}}})),N.useEffect((function(){return J.current=new M.Editor(X.current,q()),Object(C.a)(g,J.current.getContent(),!0),Z.current=S,j&&J.current.focus(),Object(l.a)(g,J.current,null),function(){J.current&&(Object(l.c)(g,J.current,null),J.current.dispose(),J.current=null)}}),[g.editorId]);var q=N.useCallback((function(){var e=Object(c.a)(S),t=Object(r.c)(Object(r.b)(i.c),Object(T.l)()?Object(r.b)(i.a):Object(r.b)(i.b)),n=Object(a.j)(Object(a.j)([],Object(a.g)(k||[])),[new A({mergeInNewLineWhenBackspaceOnFirstChar:!0}),new D((function(e){return t+"\r\n"+e})),new L,new z,new R,new _,b&&new G(b,I),new w(g),new H(10,10,Object(Q.i)().themePrimary,!0),new O(g,K,V),new F,W]),o=function(e){return{replaceWithNode:s.replaceWithNode,editTable:s.editTable,formatTable:s.formatTable,createVTable:function(e){return new u.VTable(e)},observeMutation:f(e),observeResize:d(e),spellCheck:m(e)}}(X.current);n.forEach((function(e){return Object(h.a)(e)&&e.setPluginUtils(o)}));var l=u.HtmlSanitizer.convertInlineCss(g.content),y=["ListChain","MergePastedLine","NewBullet","NewIndentation","NewNumbering"];Object(p.i)("doc-edge-link")&&y.push("PasteWithLinkPreview"),Object(p.i)("cmp-singleDirImgResize")&&y.push("SingleDirectionResize");var C=Y?{triggerEvent:ie(g.editorId)}:null;return{plugins:n,defaultFormat:e,undoSnapshotService:Object(E.a)(g),initialContent:l,inDarkMode:S,experimentalFeatures:y,allowKeyboardEventPropagation:!0,scrollContainer:P&&Object(u.findClosestElementAncestor)(X.current,X.current.ownerDocument.body,P),onExternalContentTransform:function(e){return Object(v.a)(e,Object(Q.i)().white,!0)},coreApiOverride:C}}),[g.editorId]),$=N.useCallback((function(){Object(C.a)(g,J.current.getContent()),U&&U()}),[g.editorId]),ee=g.textDirection?"rtl"===g.textDirection:Object(x.a)().SessionSettings.IsUserCultureRightToLeft;return J.current&&S!=Z.current&&(Z.current=S,J.current.setDarkModeState(S)),N.createElement(N.Fragment,null,N.createElement("div",{ref:X,dir:ee?"rtl":"ltr",className:fe(o,se.overflowHidden,se.textSelectable,{resetColors:!S,anchorReset:S}),onBlur:$,onFocus:n,role:"textbox","aria-multiline":"true","aria-label":y||b}),N.createElement("div",null),N.createElement(B,{plugins:k}))}),{forwardRef:!0});t.a=de},9477:function(e,t,n){(t=e.exports=n(77)(!1)).push([e.i,"._2s9KmFMlfdGElivl0o-GZb{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--purple:var(--fallback-purple);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary)}html[dir] ._2s9KmFMlfdGElivl0o-GZb{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}._17ghdPL1NLKYjRvmoJgpoK{user-select:text;-moz-user-select:text;-ms-user-select:text;-webkit-user-select:text}.CAUXSSmBTHvYTez0U6p3M{overflow:hidden}.yfRvh-CU21dFu_j7B1j_j a:link{color:#ba7cff}.yfRvh-CU21dFu_j7B1j_j a:visited{color:#e49fff}",""]),t.locals={resetColors:"_2s9KmFMlfdGElivl0o-GZb",textSelectable:"_17ghdPL1NLKYjRvmoJgpoK",overflowHidden:"CAUXSSmBTHvYTez0U6p3M",anchorReset:"yfRvh-CU21dFu_j7B1j_j"}},9478:function(e){e.exports=JSON.parse('{"c":"tea","a":"uea","b":"vea"}')},9507:function(e,t,n){"use strict";var a=n(2);t.a=Object(a.mutatorAction)("setPlainTextEditorSelection",(function(e,t,n){e.selectionStart=t,e.selectionEnd=n}))}}]);
//# sourceMappingURL=owa.MailBoot~HtmlEditor.js.map
self.scriptsLoaded['owa.MailBoot~HtmlEditor.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailBoot~HtmlEditor.js'] = (new Date()).getTime();